---
Author: "Randall Crawford"
title: "Assignment 2"
output: Markdown.Rmd
---
##SET UP
set working directory and load dataset
```{r}
myDataLocation <- "C:\\Program Files\\R\\ANA 600\\R Data\\Assignment2"

setwd(myDataLocation)

IBM_data <- read.csv(file = "WA_Fn-UseC_-HR-Employee-Attrition.csv", header = TRUE)
```
##SET UP
Next load favorite packages
```{r}
library(dplyr) 
library(ggplot2)
library(ggformula)
library(supernova)
library(lsr)
library(mosaic)
```
##ACTIVITY
**Part 1. Purpose**

Describe three or four interesting hypotheses that you could ask with this data for one outcome (attrition, performance, age, etc.) variable. 

Each hypothesis should have one explanatory variable. **Your explanatory variables must include one quantitative variable and one categorical variable.** Write the relationships in word equations and give your interpretation for each.

1) What is the average age (quant) of the people in each department (cat)?
####Age = b0 + b1*Department + e                                                                                                                               The categorical variable Department is being used to describe the quantitative variable Age.####

2) What is the hourly rate (quant) for m/f employees by job role (cat)?
####HourlyRate = b0 + b1*JobRole + e                                                                                                                            The categorical variable JobRole with respects to the categorical variable Gender is being used to describe the quantitative variable HourlyRate.####

3) Can we identify a trend between age (quant) and job satisfaction(cat, num)?
####Age = b0 + b1*JobSatisfaction + e                                                                                                                          The numeric categorical variable JobSatisfaction is being used to describe quantitative variable Age.####

4) Can we identify trends between employee attrition (cat) and age(quant) or salary (quant) or percent salary hike (quant)?
####Age or MonthlyIncome or PercentSalaryHike = b0 + b1*Attrition + e                                                                                           The categorical variable Attrition is being used to describe The quantitative variables (Age, MonthlyIncome, PercentSalaryHike).####

**Part2: Data**

a) Describe the characteristics (demographics) of your sample (see Week One Assignment). 
    -This is where you are reviewing each variable and understanding whether it is cat or quant, and made up of numeric or str characters.
    
```{r}
View(IBM_data)
str(IBM_data)
```
####There are 1470 total observations in the dataset.####

####There are 35 variables in the dataset:####

####Quantitative Variables: Age, DailyRate, DistanceFromHome, HourlyRate, MonthlyIncome, MonthlyRate, NumCompaniesWorked, PersentSalaryHike,                       TotalWorkingYears, TrainingTimesLastYear, YearsAtCompany, YearsInCurrentRole, YearsSinceLastPromotion, YearsWithCurrentManager                                   EmployeeCount and StandardHours are quantitative variables, but don't seem to vary much at all in the dataset.####
  
####Categorical Variables (string): Attrition, BusinessTravel, Department, EducationField, Gender, JobRole, MaritalStatus, Over18, OverTime####

####Categorical Variables (numeric): Education*, EmployeeNumber, EnvironmentSatisfaction**, JobInvolvement**, JobLevel, JobSatisfaction**,                         PerformanceRating***, RelationshipSatisfaction**, StockOptionLevel, WorkLifeBalance****####                                                                                              *     1 'Below College', 2 'College', 3 'Bachelor', 4 'Master', 5 'Doctor'                                                                                       **    1 'Low', 2 'Medium', 3 'High", 4 'Very High'                                                                                                               ***   1 'Low', 2 'Good', 3 'Excellent', 4 'Outstanding'                                                                                                          ****  1 'Bad', 2 'Good', 3 'Better', 4 'Best'

b) Create a categorized variable from a quantitative variable that describes something about your sample, and include it in your description. (perhaps age or salary or categories) 

####Performed some preliminary evaluation (a five point data summary and a histogram with boxplot overlay) on the data for the                                  MonthlyIncome quantitative variable.####

```{r}
favstats(IBM_data$MonthlyIncome)
gf_histogram(~ MonthlyIncome, data = IBM_data, fill = "green", color = "black", linewidth = 0.5) %>%
  gf_boxplot(fill = "purple", width = 20)
```
####Created a categorical variable MonthlyIncome_Categorized from the quantitative variable MonthlyIncome.####

```{r}
IBM_data$MonthlyIncome_Categorized <- cut(IBM_data$MonthlyIncome, breaks = c(-Inf, 2911, 8379, Inf), labels = c("Lower", "Middle", "Higher"))
str(IBM_data)
```

c) Describe the criteria you used to define the categories. 

####Summary statistics were generated on the quantitative variable MonthlyIncome to understand the 1st and 3rd Quartile results.                                The generated 1st and 3rd Quartile results were used to define three categories (Lower, Middle, Upper) from the variable's values.                             The three categories (lower, Middle, Upper) were used to create the categorized variable MonthlyIncome_Categorized.####

d) Report descriptive statistics **str(myData$variable)** and five-number summaries **favstats(myData$quantvar)** of your (1) outcome and (3) explanatory variables.
    - remember favstats is only for numerics (quant vars), and tally() or boxplots can be used for categorical vars.
    
```{r}
str(IBM_data$MonthlyIncome_Categorized)
tally(~ MonthlyIncome_Categorized, data = IBM_data)
```
```{r}
str(IBM_data$Age)
favstats(IBM_data$Age)
```
```{r}
str(IBM_data$NumCompaniesWorked)
favstats(IBM_data$NumCompaniesWorked)
gf_histogram(~ NumCompaniesWorked, data = IBM_data, fill = "green", color = "black", linewidth = 0.5, binwidth = 1) %>%
  gf_boxplot(fill = "purple", width = 30, color = "black", linewidth = 1)
```
```{r}
str(IBM_data$TotalWorkingYears)
favstats(IBM_data$TotalWorkingYears)
gf_histogram(~ TotalWorkingYears, data = IBM_data, fill = "green", color = "black", linewidth = 0.5) %>%
  gf_boxplot(fill = "purple", width = 15, color = "black", linewidth = 1) 
```

e) Remove outliers and describe how and why you removed them.

```{r}
IBM_data_Filter1 <- filter(IBM_data, MonthlyIncome < 8379 + (8379-2911) * 1.5)
tally(IBM_data_Filter1)
```
```{r}
IBM_data_Filter2 <- filter(IBM_data_Filter1, NumCompaniesWorked < 4 + (4-1) * 1.5)
tally(IBM_data_Filter2)
```
```{r}
IBM_data_Filter3 <- filter(IBM_data_Filter2, TotalWorkingYears < 15 + (15-6) * 1.5)
tally(IBM_data_Filter3)
```
####Evaluated Maximum and Minimum values associated with the quantitative variable MonthlyIncone used to derive the categorical variable MonthlyIncome_Categorized, and the three quantitative variables chosen (Age, NumCompaniesWorked, TotalWorkingYears).  For those with a                     Maximum value greater than Q3 + (Q3-Q1) * 1.5 or a Minimum value less than Q1 - (Q3-Q1) * 1.5, a filter was created to remove the data rows                    not conforming to that outlier standard.  Three of the aforementioned quantitative variables were identified as having Maximum values that                    were greater than the previously mentioned outlier standard (MonthlyIncome, NumCompaniesWorked, TotalWorkingYears), and a filter was applied                    to each to remove the outlier data rows.####  

####Special Note: Even though there were outliers that exceeded the mentioned outlier standard, I will be looking at the unfiltered dataset                     in Part3: Visualizations first, before deciding whether or not to use a filtered dataset.  After reviewing the histograms with boxplot                          overlays for each quantitative variable that was chosen, the dispersement and quantity of outliers still seemed relevant to the created                      categorical variable MonthlyIncome_Categorized.####

**Part3: Visualizations**
Create histograms, boxplots, jitter plots, or scatter plots, depending on whether they are quantitative/categorical and explanatory/outcome, that would best visualize your three hypotheses. Use proper conventions and labels for your axisâ€™s. Use smooth density overlays and facet_grids when applicable.              **Be sure to use titles, axis labels, and legend labels if applicable.**

####Visualizations created to describe the quantitative variable Age by the categorical variable MonthlyIncome_Categorized.####

```{r}
gf_histogram(~ Age, data = IBM_data, fill = "green", color = "black", linewidth = 0.5, title = "Age Histograms with Boxplot Overlays (Faceted by Monthly Income Categorized)") %>%
  gf_facet_grid(MonthlyIncome_Categorized ~ .) %>%
  gf_boxplot(fill = "purple", width = 10, color = "black", linewidth = 1.5)
  
gf_boxplot(Age ~ MonthlyIncome_Categorized, data = IBM_data, color = "darkblue", linewidth = 1, title = "Age Boxplots with Jitter Plot Overlays", xlab = "Monthly Income_Categorized") %>%
  gf_jitter(height = 0, color = "lightblue", alpha = 1, size = 1)
```
####Visualizations created to describe the quantitative variable NumCompaniesWorked by the categorical variable MonthlyIncome_Categorized.####

```{r}
gf_histogram(~ NumCompaniesWorked, data = IBM_data, fill = "green", color = "black", linewidth = 0.5, binwidth = 1, title = "Number of Companies Worked Histograms with Boxplot Overlays", subtitle = "(Faceted by Monthly Income_Categorized)", xlab = "Number of Companies Worked") %>%
  gf_facet_grid(MonthlyIncome_Categorized ~ .) %>%
  gf_boxplot(fill = "purple", width = 20, color = "black", linewidth = 1.5)
  
boxplot(NumCompaniesWorked ~ MonthlyIncome_Categorized, data = IBM_data, col = "lightblue", border = "darkblue", outpch = 21, outbg = "darkblue", linewidth = 1, main = "Number of Companies Worked Boxplots", xlab = "Monthly Income_Categorized", ylab = "Number of Companies Worked", yaxt = "n")
axis(2, at = seq(0, 10, 1), las = 2)
```
####Visualizations created to describe the quantitative variable TotalWorkingYears by the categorical variable MonthlyIncome_Categorized.####

```{r}
gf_histogram(~ TotalWorkingYears, data = IBM_data, fill = "green", color = "black", linewidth = 0.5, binwidth = 1, title = "Total Working Years Histograms with Boxplot Overlays", subtitle = "(Faceted by Monthly Income_Categorized)", xlab = "Total Working Years") %>%
  gf_facet_grid(MonthlyIncome_Categorized ~ .) %>%
  gf_boxplot(fill = "purple", width = 10, color = "black", linewidth = 1.5)
  
boxplot(TotalWorkingYears ~ MonthlyIncome_Categorized, data = IBM_data, col = "lightblue", border = "darkblue", outpch = 21, outbg = "darkblue", linewidth = 1, main = "Total Working Years Boxplots", xlab = "Monthly Income_Categorized", ylab = "Total Working Years", yaxt = "n")
axis(2, at = seq(0, 40, 5), las = 2)
```
**Part4: Results**
Based on your plots and analysis of the data, 
  a. Describe what the bars/points, x-axis, and y-axis mean in your plots. Be sure to give context by referencing your variables (what they mean!). Reference the figures you created in Part3 as you discuss them.
  
####Each of the quantitative variables (Age, NumCompaniesWorked, TotalYearsWorked) had a Histogram with Boxplot Overlay and a Boxplot faceted to                the categorical variable MonthlyIncome_Categorized.####  

####Regarding the Histograms with Boxplot Overlay (see below), the potential x-axis values represented the age, number of companies worked for, and          total years worked of a sample subject. The y-axis values represented the count of sample subjects. The green bars represent that count at binned          intervals of the x-axis values. The purple box on the x-axis represents half of the total sample subjects (Q1 to Q3) with the black vertical line          representing the middle sample (Q2 or Median) regarding all of the sample subjects. The black horizontal lines extend in both directions from the               purple box to the minimum and maximum values on the x-axis, excluding potential outliers. The black dots on the x-axis are potential outliers. A           histogram was allocated to each of three facets of the categorized monthly income (Lower, Middle, Higher) of the sample subjects.####  
```{r}
gf_histogram(~ TotalWorkingYears, data = IBM_data, fill = "green", color = "black", linewidth = 0.5, binwidth = 1, title = "Total Working Years Histograms with Boxplot Overlays", subtitle = "(Faceted by Monthly Income_Categorized)", xlab = "Total Working Years") %>%
  gf_facet_grid(MonthlyIncome_Categorized ~ .) %>%
  gf_boxplot(fill = "purple", width = 10, color = "black", linewidth = 1.5)
```
####Regarding the Boxplots (see below), the potential y-axis values represented the age, number of companies worked for, and                                    total years worked of a sample subject. The light blue box represents half of the total sample subjects (Q1 to Q3) with the                                     dark blue horizontal line representing the middle sample (Q2 or Median) of all sample subjects. The dotted dark blue vertical                                  lines extend in both directions from the light blue box to the minimum and maximum values, excluding potential outliers. The                                     dark blue dots are the potential outliers. A boxplot was allocated to each of three facets of the categorized monthly income                                    (Lower, Middle, Higher) of the sample subjects.#### 
```{r}
boxplot(TotalWorkingYears ~ MonthlyIncome_Categorized, data = IBM_data, col = "lightblue", border = "darkblue", outpch = 21, outbg = "darkblue", linewidth = 1, main = "Total Working Years Boxplots", xlab = "Monthly Income_Categorized", ylab = "Total Working Years", yaxt = "n")
axis(2, at = seq(0, 40, 5), las = 2)
```

  b. What can you say from the distributions of your variables about their different characteristics     
     (e.g., shape, center, spread, kurtosis, skew, and outliers)?
     
####Distribution evaluation for the quantitiative variable MonthlyIncome that was used to create the categorical variable MonthlyIncome_Categorized.####

####The shape of the distribution is slightly bi-modal with noticeable increase in the number of monthly incomes above 16,000, most of these are          potential outliers. This shape indicates a higher level of kurtosis in the distribution. The mean is greater than the median, and the mode is less             than the mean and the median, indicating a right-skewed distribution.####
```{r}
favstats(IBM_data$MonthlyIncome)
gf_histogram(~ MonthlyIncome, data = IBM_data, fill = "green", color = "black", linewidth = 0.5) %>%
  gf_boxplot(fill = "purple", width = 20, color = "black", linewidth = 1)
```  

####Distribution evaluation for the quantitative variable Age.####

####The shape of the distribution is uni-modal with an appearance of normality. The mean and the median are close, but the mode is somewhat less                than the mean and the median, giving the distribution a slight right-skew. No outliers are present.####
```{r}
favstats(IBM_data$Age)
gf_histogram(~ Age, data = IBM_data, fill = "green", color = "black", linewidth = 0.5) %>%
  gf_boxplot(fill = "purple", width = 15, color = "black", linewidth = 1)
```  
####Distribution evaluation for the quantitative variable NumCompaniesWorked.####

####The shape of the distribution is mostly uni-modal around 1 company worked at, but the count perist out to 9 that is viewed as a potential              outlier. This shape indicates a moderate level of kurtosis in the distribution. The mean is greater than the median, and the mode is less than                 the mean and the median, indicating a right-skewed distribution.####
```{r}
favstats(IBM_data$NumCompaniesWorked)
gf_histogram(~ NumCompaniesWorked, data = IBM_data, fill = "green", color = "black", linewidth = 0.5, binwidth = 1) %>%
  gf_boxplot(fill = "purple", width = 30, color = "black", linewidth = 1)
```  

####Distribution evaluation for the quantitative variable TotalWorkingYears.####

####The shape of the distribution is possibly bi-modal with most working 8-10 years, but a significant portion working 2-4 years.There are                       a significant number of potential outliers above 28 working years. This shape indicates a higher level of kurtosis in the distribution. The                    mean is greater than the median, and the mode is less than the mean and the median, indicating a right-skewed distribution.####
```{r}
favstats(IBM_data$TotalWorkingYears)
gf_histogram(~ TotalWorkingYears, data = IBM_data, fill = "green", color = "black", linewidth = 0.5) %>%
  gf_boxplot(fill = "purple", width = 15, color = "black", linewidth = 1) 
```
 
  c. What are your conclusions about the relationships between the outcome variable with the explanatory variables for your three hypotheses?

####The quantitative variable Age has a positive correlation (0.498 rounded) with the quantitive variable MonthlyIncome, and could possibly have                 a moderate contribution to the estimation of it.####
```{r}
ggplot(
  IBM_data,
  aes(
    x = Age,
    y = MonthlyIncome
  )
) +
  geom_point(
    color = "blue",
    size = 1,
    shape = 16
  ) +
  scale_y_continuous(
    labels = label_dollar()
  ) +
  coord_cartesian(
    ylim = c(0, 20000)
  ) +
  geom_smooth(
    method = "lm",
    se = FALSE,
    color = "red"
  ) +
  labs(
    title = "Scatterplot of Monthly Income to Age",
    x = "Age",
    y = "Monthly Income"
  )
cor(IBM_data$Age, IBM_data$MonthlyIncome)
```

####The quantitative variable NumCompaniesWorked has a positive correlation (0.150 rounded) with the quantitive variable MonthlyIncome, and could possibly have a slight contribution to the estimation of it.####
```{r}
ggplot(
  IBM_data,
  aes(
    x = NumCompaniesWorked,
    y = MonthlyIncome
  )
) +
  geom_point(
    color = "blue",
    size = 1,
    shape = 16
  ) +
  scale_x_continuous(
    breaks = breaks_pretty(n = 10)
  ) +  
  scale_y_continuous(
    labels = label_dollar()
  ) +
  coord_cartesian(
    ylim = c(0, 20000)
  ) +
  geom_smooth(
    method = "lm",
    se = FALSE,
    color = "red"
  ) +
  labs(
    title = "Scatterplot of Monthly Income to Number of Companies Worked",
    x = "Number of Companies Worked",
    y = "Monthly Income"
  )
cor(IBM_data$NumCompaniesWorked, IBM_data$MonthlyIncome)
``` 

####The quantitative variable TotalWorkingYears has a positive correlation (0.773 rounded) with the quantitive variable MonthlyIncome, and                    could possibly have a significant contribution to the estimation of it.####
```{r}
ggplot(
  IBM_data,
  aes(
    x = TotalWorkingYears,
    y = MonthlyIncome
  )
) +
  geom_point(
    color = "blue",
    size = 1,
    shape = 16
  ) +
  scale_y_continuous(
    labels = label_dollar()
  ) +
  coord_cartesian(
    ylim = c(0, 20000)
  ) +
  geom_smooth(
    method = "lm",
    se = FALSE,
    color = "red"
  ) +
  labs(
    title = "Scatterplot of Monthly Income to Total Years Worked",
    x = "Total Years Worked",
    y = "Monthly Income"
  )
cor(IBM_data$TotalWorkingYears, IBM_data$MonthlyIncome)
```
 
  d. What can you say about the population sampled, and the data-generating process?
  
####After grouping the quantitative/outcome variables (Age, NumCompaniesWorked, TotalWorkingYears) to the categorized/explanatory variable (MonthlyIncome_Categorized) for histogram and boxplots, I realized that the potential outliers in the datasets for each quantitative variable                 were better to be left in those datasets. See previous examples below. It made for a reasonably good representation for the Lower, Middle, and                   Higher monthly income categories. From what I could see of the IBM_data dataset through my specific investigation, the data seemed clean, valid,                and potentially representative of a larger population.####   
```{r}
gf_histogram(~ TotalWorkingYears, data = IBM_data, fill = "green", color = "black", linewidth = 0.5) %>%
  gf_boxplot(fill = "purple", width = 15, color = "black", linewidth = 1)

boxplot(TotalWorkingYears ~ MonthlyIncome_Categorized, data = IBM_data, col = "lightblue", border = "darkblue", outpch = 21, outbg = "darkblue", linewidth = 1, main = "Total Working Years Boxplots", xlab = "Monthly Income_Categorized", ylab = "Total Working Years", yaxt = "n")
axis(2, at = seq(0, 40, 5), las = 2) 
```
Generalize your inferences from this sample to the intended population using APA style reporting.

####Understanding Monthly Income Categorically, And What Other Variables That Possible Contribute To It####

####The Quantitative Variables Used: Age, Number of Companies Worked, Total Working Years####

####The Categorical Variable Used: Monthly Income (Lower, Middle, Higher)####

####General Inference: Experience contributes to monthly income significantly.####

####Specific Inferences: Regarding age, the passage of time allows us to acquire general knowledge and experience that can benefit individual                    compensation in their employment. Regarding the number of companies worked, the diverse knowledge, skills, and experience gained from having                worked for a number of companies cannot be understated, but extended tenure at those companies often leads to better individiual compensation.                  Regarding total working years, the practical knowledge, skills, and experience gained from working extensively definitely drives better individual compensation.#### 

**Step 5: Implications**
Give interesting examples that could result in measurement error, sampling error, and mistakes. What are other variables in the dataset that could help explain variation in your outcome? What other variables, not in the dataset, could also explain variation in the outcome? How so? Are there any confounding variables that may change your interpretations?

####Potential Error or Mistakes: Measurement error could from inaccurate results provided by sample subjects. Sampling error could come from                   not choosing a proper sample group that is not truly representative of a larger population. Mistakes could be made when gathering, processing,                 transferring, and storing the sample results.####
 
####Quantitative variables to be considered for understanding monthly income: TrainingTimesLastYear, YearsAtCompany, YearsInCurrentRole,     YearsSinceLastPromotion, and YearsWithCurrentManager. Categorical Variables (string) that could be considered for understanding monthly income:        BusinessTravel, EducationField, JobRole, and OverTime. Categorical Variables (numeric) that could be considered for understanding monthly income:         Education, JobInvolvement, JobSatisfaction, and PerformanceRating.####

####Quantitative variables that seem confounding: HourlyRate, DailyRate, and MonthlyRate.  Believe these variable values could play a roll, but             unsure how they are derived.####

 **Step 6: Discussion**
To recap, how could your analysis report be used by an employer? What do you believe is the practical significance of your analysis? Why is it important to understand the nature and circumstances that could influence the relationship between your outcome and explanatory variables?

####With further evaluation and the introduction of more variables to estimate monthly income, there could be a linear regression model consisting              of significant variables derived. This could help the company understand what is driving individual compensation.####

####The initial approach was to look at individual experience, and how that plays out with individual compensation.####
